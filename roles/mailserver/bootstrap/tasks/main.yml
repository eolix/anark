---
- name: Update apt cache
  apt: update_cache=yes

- name: Upgrade all safe packages
  apt: upgrade=safe

- name: Install basic packages
  apt: pkg={{ item }} state=installed
  with_items:
    - apt-transport-https
    - git
    - htop
    - iftop
    - iotop
    - python3-software-properties
    - python3-pip
    - python3-setuptools
    - screen
    - sudo
    - unattended-upgrades
    - vim
    - nano
    - zip
    - openssl
    - whois

- name: Change hostname
  hostname:
    name: "mail.{{mail_domain}}"

- name: Add hostname to to /etc/hosts
  lineinfile:
    dest: /etc/hosts
    regexp: '^127\.0\.0\.1[ \t]+localhost'
    line: "127.0.0.1 localhost mail.{{mail_domain}} mail"
    state: present

- name: Add hostname to to /etc/mailname
  lineinfile:
    dest: /etc/mailname
    line: "mail.{{mail_domain}} mail"
    state: present
